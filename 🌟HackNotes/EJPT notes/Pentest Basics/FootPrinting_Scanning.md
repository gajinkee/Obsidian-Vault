#scanning #footprinting
# Ping sweeping
- Map out the network increase attack surface

linux:
fping -a -g IPRANGE (eg 10.54.12.0/24)
-a alive hosts only
-g ping sweep instead of standard ping
redirect error msgs to null
`fping -a -g 192.168.82.0/255 2>/dev/null`

## Nmap
-sn ping sweep scan command
`nmap -sn 200.200.0.0/16`
save host list in a file and input it using
`nmap -sn -iL hostlist.txt`

### OS fingerprinting:
- guesswork for everynetwork node: Servers,routers,firewalls,hosts,printers etc)
- with a given confidence level:
	- 200.200.3.1 PAN-OS 85% confidence
- Nmap does active fingerprinting:
 `namp -Pn -O <targets>`
- -Pn skips ping scan for if you already know the hosts is/are alive
- finetuning:
	- --osscan-limit : limit to promising targets if you have alot of hosts to scan
	- --osscan-guess : guess OS more aggressively

### Port Scanning
- finds software version and open ports services/daemon running on a server ( -sV flag)
	- Performs 3 way and detects Banner after sending ACK then send RST+ACK
- Scans TCP and UDP (normal 3way -sT flag)
NOTE : Every TCP connect scan probe gets recorded in the daemon logs(seen as a legitimate connection,
But sysadmins can easily detect the scan
Hence, TCP SYNC scan used so the 3wayhandshake is not complete, sends a RST right after syn+ack received
(-ie -sS flag)

Specifying targets posiible formats:
	- DNS names
	- ipadress lists CIDR notation
	- wildcards (eg 192.168.1.* or 192.168.`*`.1 )
	- ,ranges,octet lists 
	- input files -iL
10.14.33.0-122 10.14.33.144-255
200.200.6-12.`*`
10.14.33.1,3,17



Bypass firewalls that block pings:
-Pn to switch to force scan on server treating it as alive to find open ports
list of common ports/services
![[portscommon.png]]

if service version not recognised (tcpwrapped etc) might be firewall
--resaon flag to show why port is marked closed/open
- helps see if its a firewall (eg host send RST eventho uk port is open)
- 
## MassScan
- Scans for large networks/thousands of ip addresses 
- like nmap but faster but less accurate


## Lab work
1.  How many machines are there?  6 inclding myself
2.  What ports are open on [pc1.ine.local](http://pc1.ine.local/) machine? 80 http 443 https 3306 mysql
3.  What OS is running on machine [pc1.ine.local](http://pc1.ine.local/) machine? Linux 4.15 - 5.6
4.  What services are running on [pc2.ine.local](http://pc2.ine.local/) machine? None
5.  What is the version of the FTP server running on one of the machines? pc4.ine.local vsftpd 3.0.3
6.  A caching server is also running on one of the machines. What is the domain name of that machine? pc3.ine.local Memcached 1.5.12
7.  A NoSQL database and SQL database services are running on different machines. Can we use Nmap scripts to extract some information from those?
	1. 110.3 has mysql pc1
	2. NoSQL
	3. 110.4 pc2 
	4. Mondodb 3.6.3
flag on ftp pc4: 4267bdfbff77d7c2635e4572519a8b9c

11000000.11111111.01101110. 00000000 / 24 means the first 24 bits is network bits so only back part scanned

192.255.110.0/6 means only the first 6 bits are network...so ure scanning 2^26 hosts hahahah fk up
# So
#cidr
you shud be scanning 192.255.110.0/24 so only 2^8 hosts are scanned

Also:
etc/hosts file gives the domain names of servers the machine is connected to (used for pivoting)

## NMap scripts

Some scripts to probe DB info/databases/bruteforce authentication
nmap -p27017 --script=mongodb-info target-2 | less
nmap -p27017 --script=mongodb-databases target-2
nmap -p27017 --script=mongodb-brute target-2

or 
use all with wildcard `*`
nmap --script=mysql-* target-1

But sending too many request can cause connection error due to host blocking ur requests

