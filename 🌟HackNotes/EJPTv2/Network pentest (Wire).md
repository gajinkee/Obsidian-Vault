1. Network attacks
	- Service related
	- MiTM attack
2. Packet analysis
3. Labs

Network Services:
- ARP
- DHCP
- SMB
- FTP
- Telnet
- SSH etc

MIM attacks:
- intercept traffic between 2 victims
- In the past, phy connection to the hub allows to view all traffic
- Now, switched dont allow that (smarterish) so, Common attack:
	- Connect to a SPAN port which listens too all traffic on a switch
	- ARP poisoning
		- Send out ARP req to say that attacker is a certain ip
		- All traffic for that ip is sent to the attacker (packets are bound to an ip addr)
	- Promiscuous mode --> listen to all traffic

### Configuring wireshark
pcaps --> readable and savable files to see network traffic
b4 capturing traffic choose the right eth

add coloumn by right clicking the column...add for more data eg source port/dest port etc

Right click on indiv reqs and follow TCP/HTTP streams etc to view the full req


### Tshark
`tshark -v`
`tshark -r filename.pcap`  --> spits out all the data (must filter/grep this data )
`tshark -r filename.pcap -z io,phs -q`  --> spits out hierachy of data (how many of each tpye of data)

total number of packets
`tshark -r HTTP_traffic.pcap | wc -l`

stop after first 100 packets
`tshark -r HTTP_traffic.pcap -c 100`

filtering tshark data
`tshark -r filename.pcap -Y 'http' | more` --> spits all http data

data sent between 2 hosts addr
`tshark -r filename.pcap -Y 'ip.src==192.168.252.128 && ip.dst==52.32.74.91 ' | more`

All the http get reqs
`tshark -r filename.pcap -Y 'http.request.method==GET' | more`

Set specific fields (here: Time | ip source | full url of http req)
`tshark -r filename.pcap -Y 'http.request.method==GET' -Tfields -e frame.time -e ip.src -e http.request.full_uri | more`

Look for a real expression inside packets (eg password)
`tshark -r filename.pcap -Y 'http contains password' | more`

Looking for ip dest sent for nytimes
`tshark -r HTTP_traffic.pcap -Y "http.request.method==GET && http.host==www.nytimes.com" -Tfields -e ip.dst`

OS of a given ip addr
` tshark -r HTTP_traffic.pcap -Y "ip.src==192.168.252.128 && http" -Tfields -e http.user_agent`

### ARP spoofing
- Fake that the given ip is at ur MAC address when it is not
set wire shark to the required interface (eth1 for this instance)

Configure the Kali instance to forward IP packets:
`echo 1 > /proc/sys/net/ipv4/ip_forward`

- Spoofs ur ip telling .36 that u r .37 --> .36 sends packet meant for .37 to you(.140)
- and tells .37 that you are .36 (ie MIM all traffic bewteen the 2 is captured)
`arpspoof -i eth1 -t 10.100.13.37 -r 10.100.13.36`

### Wifi traffic analysis
- also using wireshark but diff interface

find traffic from a certain SSID
`wlan contains <SSID name>`

filter for data sent to a certain addr
`wlan.a`


tshark analysis
display only wifi trafic
`tshark -r WiFi_traffic.pcap -Y "wlan"`

display only deauth packets
`tshark -r WiFi_traffic.pcap -Y "wlan.fc.type_subtype==0x000c"`

display only WPA handshakes
`tshark -r WiFi_traffic.pcap -Y "eapol"`

display BSSID (MAC addr) from a given SSID
`tshark -r WiFi_traffic.pcap -Y "wlan.ssid==LazyArtists" -Tfields -e wlan.bssid`

Find device used by a give MAC addr
`tshark -r WiFi_traffic.pcap -Y "wlan.ta==5c:51:88:31:a0:3b && http" -Tfields -e http.user_agent`
