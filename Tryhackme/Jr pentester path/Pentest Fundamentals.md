**Rules of Engagement (ROE)**
  

### Permission
This section of the document gives explicit permission for the engagement to be carried out. This permission is essential to legally protect individuals and organisations for the activities they carry out.

### Test Scope
This section of the document will annotate specific targets to which the engagement should apply. For example, the penetration test may only apply to certain servers or applications but not the entire network.

### Rules
The rules section will define exactly the techniques that are permitted during the engagement. For example, the rules may specifically state that techniques such as phishing attacks are prohibited, but MITM (Man-in-the-Middle) attacks are okay.


## Pentest methodologies
Information Gathering
This stage involves collecting as much publically accessible information about a target/organisation as possible, for example, OSINT and research.

**Note:** This does not involve scanning any systems.

Enumeration/Scanning
This stage involves discovering applications and services running on the systems. For example, finding a web server that may be potentially vulnerable.

Exploitation
This stage involves leveraging vulnerabilities discovered on a system or application. This stage can involve the use of public exploits or exploiting application logic.

Privilege Escalation
Once you have successfully exploited a system or application (known as a foothold), this stage is the attempt to expand your access to a system. You can escalate horizontally and vertically, where horizontally is accessing another account of the same permission group (i.e. another user), whereas vertically is that of another permission group (i.e. an administrator).

Post-exploitation
This stage involves a few sub-stages:  
**1.** What other hosts can be targeted (pivoting)

**2.** What additional information can we gather from the host now that we are a privileged user

**3.**  Covering your tracks

**4.** Reporting

## Pentest Frameworks
**OSSTMM**
[The Open Source Security Testing Methodology Manual](https://www.isecom.org/OSSTMM.3.pdf) provides a detailed framework of testing strategies for systems, software, applications, communications and the human aspect of cybersecurity.
The methodology focuses primarily on how these systems, applications communicate, so it includes a methodology for:

1.  **Telecommunications (phones, VoIP, etc.)**
2.  Wired Networks
3.  Wireless communications

**OWASP**
The "[Open Web Application Security Project](https://owasp.org/)" framework is a community-driven and frequently updated framework used solely to test the security of **web applications and services.**

The foundation regularly [writes reports](https://owasp.org/www-project-top-ten/2017/) stating the top ten security vulnerabilities a web application may have, the testing approach, and remediation.

**NIST Cybersecurity Framework 1.1**
The [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework) is a popular framework used to improve an organisations cybersecurity standards and manage the risk of cyber threats. This framework is a bit of an honourable mention because of its popularity and detail.

The framework provides guidelines on security controls & benchmarks for success for organisations from critical infrastructure (power plants, etc.) all through to commercial.  There is a limited section on a standard guideline for the methodology a penetration tester should take.


**NCSC CAF**
The [Cyber Assessment Framework](https://www.ncsc.gov.uk/collection/caf/caf-principles-and-guidance) (CAF) is an extensive framework of fourteen principles used to assess the risk of various cyber threats and an organisation's defences against these.

The framework applies to organisations considered to perform "vitally important services and activities" such as critical infrastructure, banking, and the likes. The framework mainly focuses on and assesses the following topics:
-   Data security
-   System security
-   Identity and access control
-   Resiliency
-   Monitoring
-   Response and recovery planning


## Principles of Security
Defence in depth
Defence in Depth is the use of multiple varied layers of security to an organisation's systems and data in the hopes that multiple layers will provide redundancy in an organisation's security perimeter.

CIA triad...
The CIA triad is unlike a traditional model where you have individual sections; instead, it is a continuous cycle. Whilst the three elements to the CIA triad can arguably overlap, if even just one element is not met, then the other two are rendered useless (similar to the fire triangle). If a security policy does not answer these three sections, it is seldom an effective security policy.

**Confidentiality**
This element is the protection of data from unauthorized access and misuse. Organisations will always have some form of sensitive data stored on their systems. To provide confidentiality is to protect this data from parties that it is not intended for.

There are many real-world examples for this, for example, employee records and accounting documents will be considered sensitive. Confidentiality will be provided in the sense that only HR administrators will access employee records, where vetting and tight access controls are in place. Accounting records are less valuable (and therefore less sensitive), so not as stringent access controls would be in place for these documents. Or, for example, governments using a sensitivity classification rating system (top-secret, classified, unclassified)

**Integrity**
The CIA triad element of integrity is the condition where information is kept accurate and consistent unless authorized changes are made. It is possible for the information to change because of careless access and use, errors in the information system, or unauthorized access and use. In the CIA triad, integrity is maintained when the information remains unchanged during storage, transmission, and usage not involving modification to the information. Steps must be taken to ensure data cannot be altered by unauthorised people (for example, in a breach of confidentiality).

Many defences to ensure integrity can be put in place. Access control and rigorous authentication can help prevent authorized users from making unauthorized changes. Hash verifications and digital signatures can help ensure that transactions are authentic and that files have not been modified or corrupted.

**Availability**
In order for data to be useful, it must be available and accessible by the user.
The main concern in the CIA triad is that the information should be available when authorised users need to access it.

Availability is very often a key benchmark for an organisation. For example, having 99.99% uptime on their websites or systems (this is laid out in Service Level Agreements). When a system is unavailable, it often results in damage to an organisations reputation and loss of finances. Availability is achieved through a combination of many elements, including:

-   Having reliable and well-tested hardware for their information technology servers (i.e. reputable servers)
-   Having redundant technology and services in the case of failure of the primary
-   Implementing well-versed security protocols to protect technology and services from attack

### Principles of Priveledge

The levels of access given to individuals are determined on two primary factors:
-   The individual's role/function within the organisation
-   The sensitivity of the information being stored on the system

Two key concepts are used to assign and manage the access rights of individuals, two key concepts are used: Privileged Identity Management (PIM) and Privileged Access Management (or PAM for short).
PIM is used to translate a user's role within an organisation into an access role on a system. 
- principle of least privilege. Simply, users should be given the minimum amount of privileges, and only those that are absolutely necessary for them to perform their duties.
 
PAM is the management of the privileges a system's access role has, amongst other things.
-  It also encompasses enforcing security policies such as password management, auditing policies and reducing the attack surface a system faces.
-  incorporates more than assigning access

## Security Models 
Effective security models used to achieve the three elements of the CIA triad.

### **The Bell-La Padula Model**
The Bell-La Padula Model is used to achieve confidentiality. This model has a few assumptions, such as an organisation's hierarchical structure it is used in, where everyone's responsibilities/roles are well-defined.
The model works by granting access to pieces of data (called objects) on a strictly need to know basis. This model uses the rule **"no write down, no read up"**.
![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/0e6e5d9d80785fc287b4a67e1453b295.png)



### **Biba Model**
The Biba model is arguably the equivalent of the Bell-La Padula model but for the integrity of the CIA triad.
More fo software development where **"no write up, no read down"** (ie can  read all the code but can only edit parts u have access to)
![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/895ba351ef24ef6495d290222e49470e.png)

## Threat monitoring and incident response
The threat modelling process is very similar to a risk assessment made in workplaces for employees and customers. The principles all return to:
-   Preparation
-   Identification
-   Mitigations
-   Review

It is, however, a complex process that needs constant review and discussion with a dedicated team. An effective threat model includes:
-   Threat intelligence
-   Asset identification
-   Mitigation capabilities
-   Risk assessment

 There are frameworks for this like **STRIDE** (**S**poofing identity, **T**ampering with data, **R**epudiation threats, **I**nformation disclosure, **D**enial of Service and **E**levation of privileges) and 
 **PASTA** (**P**rocess for **A**ttack **S**imulation and **T**hreat **A**nalysis)

### STRIDE
Spoofing
This principle requires you to authenticate requests and users accessing a system. Spoofing involves a malicious party falsely identifying itself as another.
Access keys (such as API keys) or signatures via encryption helps remediate this threat.

Tampering
By providing anti-tampering measures to a system or application, you help provide integrity to the data. Data that is accessed must be kept integral and accurate.
For example, shops use seals on food products.

Repudiation
This principle dictates the use of services such as logging of activity for a system or application to track.

Information Disclosure
Applications or services that handle information of multiple users need to be appropriately configured to only show information relevant to the owner is shown.

Denial of Service
Applications and services use up system resources, these two things should have measures in place so that abuse of the application/service won't result in bringing the whole system down.

Elevation of Privilege
This is the worst-case scenario for an application or service. It means that a user was able to escalate their authorization to that of a higher level i.e. an administrator. This scenario often leads to further exploitation or information disclosure.

### Incident response
Incidents are classified using a rating of urgency and impact. Urgency will be determined by the type of attack faced, where the impact will be determined by the affected system and what impact that has on business operations.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/ab0cc8478b0bce9a400187f559d36dd6.png)

### **C**omputer **S**ecurity **I**ncident **R**esponse **T**eam (**CSIRT**)
PICERL

Preparation
Do we have the resources and plans in place to deal with the security incident?

Identification
Has the threat and the threat actor been correctly identified in order for us to respond to?

Containment
Can the threat/security incident be contained to prevent other systems or users from being impacted?

Eradication
Remove the active threat.

Recovery 
Perform a full review of the impacted systems to return to business as usual operations.

Lessons Learned
What can be learnt from the incident? I.e. if it was due to a phishing email, employees should be trained better to detect phishing emails.